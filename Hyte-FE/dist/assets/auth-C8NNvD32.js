import{f as u}from"./fetch-CLQ4DtwB.js";const p=async n=>{n.preventDefault();const e=document.querySelector(".login-form"),s=e.querySelector("input[name=username]").value.trim(),a=e.querySelector("input[name=password]").value,c=e.querySelector("input[name=email]").value.trim(),r={username:s,password:a,email:c},l="http://localhost:3000/api/users",o={body:JSON.stringify(r),method:"POST",headers:{"content-type":"application/json"}};console.log(o);const t=await u(l,o);if(t.error){console.error("Error adding a new user:",t.error);return}t.message&&console.log(t.message,"success"),console.log(t),e.reset(),e.querySelector("input[name=username]").value=s,document.querySelector(".register-checkbox").checked=!1,document.querySelectorAll(".hidden-email").forEach(i=>{i.classList.add("hidden"),i.setAttribute("hidden","hidden"),i.tagName==="INPUT"&&i.removeAttribute("required"),document.querySelector(".loginform").value="Kirjaudu sisään"})},g=async n=>{n.preventDefault();const e=document.querySelector(".login-form"),s=e.querySelector("input[name=username]").value,a=e.querySelector("input[name=password]").value,c={username:s,password:a},r="http://localhost:3000/api/auth/login",l={body:JSON.stringify(c),method:"POST",headers:{"Content-type":"application/json"}};console.log(l);const o=await u(r,l);if(o.error){console.error("Error adding a new user:",o.error);return}o.message&&(console.log(o.message,"success"),localStorage.setItem("token",o.token),localStorage.setItem("nimi",o.user.username)),console.log(o),e.reset(),window.location.href="/src/pages/healthdiary.html"},h=async n=>{const e="http://localhost:3000/api/auth/me";let s={};s={Authorization:`Bearer ${localStorage.getItem("token")}`};const r=await u(e,{headers:s});if(r.error){console.error("Error getting personal data:",r.error);return}return r.message&&console.log(r.message,"success"),r};export{h as c,g as l,p as r};
